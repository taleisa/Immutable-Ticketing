<!DOCTYPE html>
<html>
<head>
    <title>Test Send Transaction</title>
    <script src="https://cdn.jsdelivr.net/npm/web3@1.5.2/dist/web3.min.js"></script>
</head>
<body>
    <h1>Test Buy ticket</h1>
    <button id="connect-button">Connect Metamask</button>
    <button id="send-transcation">Send Transaction</button>
    <label for="token">Token ID:</label>
    <input type="number" id="TokenId" placeholder="0"><br>
    <button id="sign-transcation">Sign Transaction</button>
    <span id="account"><br></span>
    <span id="output"></span>
    <!--<ul>
        {% for x in contract_abi %}
          <li>{{ x }}</li>
        {% endfor %} 
      </ul>-->
      <script>
        let account;
        document.getElementById('connect-button').addEventListener('click', event => {
            /* retreives user account address*/
        ethereum.request({method: 'eth_requestAccounts'}).then(accounts => {
            account = accounts[0];
            document.getElementById("account").innerText = account;

        });
        });
        document.getElementById('send-transcation').addEventListener('click', event =>{
            /* sends ether to the 'to' account*/
            let transactionParam = {
                to: '0xDFf43e81a80BdB91EF10d8316b29701d0813A2D6',
                from: account,
                value: '0x38D7EA4C68000'
                };
        ethereum.request({method: 'eth_sendTransaction', params:[transactionParam]}).then(txhash => {
            document.getElementById("output").innerText = txhash;
        });
        });
        document.getElementById('sign-transcation').addEventListener('click', event =>{
            /* buys ticket*/
            let transactionParam = {'gas': "80701", 
            'maxFeePerGas': "1221235230", 
            'maxPriorityFeePerGas': "1000000000", 
            'chainId': "1337", 
            'from': '0x79F61a835acb55212915Dd05B546517BEBb2F97D', 
            'value': "0x1c6bf52634000", 
            'nonce': "2", 
            'to': '0x15382Add19aD7DB6D6bD96cf774dafE94A0Fb731', 
            'data': '0x821895510000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000848218955100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000001479f61a835acb55212915dd05b546517bebb2f97d00000000000000000000000000000000000000000000000000000000000000000000000000000000'}; 
            /* working {
            'gas': "79541", 
            'maxFeePerGas': "1002151624", 
            'maxPriorityFeePerGas': "1000000000", 
            'chainId': "1337", 
            'from': '0x15FCf919E5Ed3d5964c3e5cD85EEFce14670AE98', 
            'value': "500000000000000", 
            'nonce': "1", 
            'to': '0xA7003eAB97BCEA0D429fB6D8E8059A7D1CC48E00', 
            'data': '0x821895510000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000848218955100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000001415fcf919e5ed3d5964c3e5cd85eefce14670ae9800000000000000000000000000000000000000000000000000000000000000000000000000000000'
            };*/ 
                /*
                {'gas': 79517,
                 'maxFeePerGas': 1003618318,
                 'maxPriorityFeePerGas': 1000000000, 
                 'chainId': 1337, 
                 'from': '0xE701AC6f4b0cc12DCF33361e79edF2cEB01A6767',
                 'value': 500000000000000000,
                 'nonce': 0, 
                 'to': '0xA7003eAB97BCEA0D429fB6D8E8059A7D1CC48E00', 
                 'data': '0x8218955100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000008482189551000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000014e701ac6f4b0cc12dcf33361e79edf2ceb01a676700000000000000000000000000000000000000000000000000000000000000000000000000000000'}
                */
        ethereum.request({method: 'eth_sendTransaction', params:[transactionParam]}).then(txhash => {
            document.getElementById("output").innerText = txhash;
        });
        });
       </script>
</body>
</html>